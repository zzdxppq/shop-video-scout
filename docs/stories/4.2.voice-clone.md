# Story 4.2: 声音克隆功能

## Status
Draft

## Story

**As a** 用户,
**I want** 使用自己的声音进行配音,
**so that** 视频更具个人特色

## Acceptance Criteria

### AC1: 上传声音样本

**Scenario**
```gherkin
GIVEN 用户想使用自己的声音
WHEN 用户上传声音样本
THEN
  - 获取OSS上传URL
  - 上传音频文件
  - 验证时长在5秒-2分钟之间
  - 创建声音样本记录
```

**Business Rules**
| ID | Rule |
|----|------|
| BR-1.1 | 支持MP3、WAV、M4A格式 |
| BR-1.2 | 时长5秒-2分钟（火山引擎Seed-TTS仅需5秒即可高质量克隆） |
| BR-1.3 | 每个用户最多保存3个声音样本 |

---

### AC2: 声音克隆处理

**Scenario**
```gherkin
GIVEN 声音样本上传成功
WHEN 系统处理克隆
THEN
  - 调用火山引擎声音复刻API (Seed-ICL)
  - 获取克隆音色ID
  - 更新样本状态为completed
```

**Business Rules**
| ID | Rule |
|----|------|
| BR-2.1 | 克隆处理预计1-3分钟 |
| BR-2.2 | 克隆成功后可永久使用 |

---

### AC3: 使用克隆声音配音

**Scenario**
```gherkin
GIVEN 用户已有克隆成功的声音
WHEN 选择我的声音进行配音
THEN
  - 使用克隆音色ID调用TTS
  - 生成配音音频
```

---

## Tasks / Subtasks

- [ ] **T1: 声音样本上传API** `[AC1]`
- [ ] **T2: Seed-ICL克隆集成** `[AC2]`
- [ ] **T3: 克隆声音TTS调用** `[AC3]`

## Dev Notes

### Provides APIs
- `POST /api/v1/voice/upload-url`
- `POST /api/v1/voice/samples`
- `GET /api/v1/voice/samples`
- `DELETE /api/v1/voice/samples/{id}`

### Dependencies
- 依赖 Story 4.1 (TTS配音服务)

### Priority
P1 - 可在核心流程完成后实现

---

## Change Log

| Date | Agent | Status Transition | Details/Link |
|------|-------|-------------------|--------------|
| 2026-01-22 | SM | Created → Draft | Story created from PRD Epic 4 |
