# Story 3.2: è„šæœ¬ç¼–è¾‘é¡µé¢

## Status
Done

## Story

**As a** ç”¨æˆ·,
**I want** æŸ¥çœ‹å’Œç¼–è¾‘AIç”Ÿæˆçš„è„šæœ¬,
**so that** å¯ä»¥ä¿®æ”¹æ–‡æ¡ˆå†…å®¹å¹¶ä¿å­˜æˆ‘çš„ä¿®æ”¹

## Acceptance Criteria

### AC1: è„šæœ¬å±•ç¤ºä¸ç¼–è¾‘

**Scenario**
```gherkin
GIVEN AIè„šæœ¬ç”Ÿæˆå®Œæˆ (task.status = 'script_ready')
WHEN ç”¨æˆ·æŸ¥çœ‹è„šæœ¬
THEN
  - åˆ†æ®µè½å±•ç¤ºè„šæœ¬å†…å®¹ï¼ˆ5-7ä¸ªæ®µè½ï¼‰
  - æ¯æ®µæ˜¾ç¤ºå¯¹åº”é•œå¤´æ ‡è®°ï¼ˆsectionåç§° + shot_idï¼‰
  - æ”¯æŒç‚¹å‡»ç¼–è¾‘ä¿®æ”¹å†…å®¹
  - æ”¯æŒæ’¤é”€ä¿®æ”¹ï¼ˆCtrl+Z / Cmd+Zï¼‰
```

**Business Rules**
| ID | Rule |
|----|------|
| BR-1.1 | ç¼–è¾‘æ—¶æ˜¾ç¤ºå­—æ•°ç»Ÿè®¡ï¼ˆå®æ—¶æ›´æ–°ï¼‰ |
| BR-1.2 | æ¯æ®µå»ºè®®å­—æ•°æç¤ºï¼šæŒ‰ estimated_duration * 4å­—/ç§’ è®¡ç®— |
| BR-1.3 | æ˜¾ç¤ºé‡æ–°ç”ŸæˆæŒ‰é’®ï¼Œå‰©ä½™æ¬¡æ•° = 5 - script_regenerate_count |
| BR-1.4 | ç¼–è¾‘çŠ¶æ€ä¸‹ç¦æ­¢ç¦»å¼€é¡µé¢ï¼ˆæœªä¿å­˜æç¤ºï¼‰ |

**Error Handling**
| Scenario | Code | Message | Action |
|----------|------|---------|--------|
| å†…å®¹ä¸ºç©º | VALIDATION_ERROR | è„šæœ¬å†…å®¹ä¸èƒ½ä¸ºç©º | ä¿å­˜æŒ‰é’®ç¦ç”¨ï¼Œæ˜¾ç¤ºçº¢è‰²è¾¹æ¡† |
| è„šæœ¬åŠ è½½å¤±è´¥ | LOAD_ERROR | è„šæœ¬åŠ è½½å¤±è´¥ï¼Œè¯·åˆ·æ–°é¡µé¢ | æ˜¾ç¤ºé‡è¯•æŒ‰é’® |
| ç½‘ç»œæ–­å¼€ | NETWORK_ERROR | ç½‘ç»œä¸ç¨³å®š | æ˜¾ç¤ºToastæç¤ºï¼Œæœ¬åœ°ä¿å­˜è‰ç¨¿ |

**UI Interaction**
| Trigger | Behavior |
|---------|----------|
| é¡µé¢åŠ è½½ | è°ƒç”¨ GET /api/v1/tasks/{id}/script è·å–è„šæœ¬å†…å®¹ |
| ç‚¹å‡»æ®µè½ | è¯¥æ®µè½è¿›å…¥ç¼–è¾‘æ¨¡å¼ï¼Œæ˜¾ç¤ºç¼–è¾‘æ¡† |
| ç¼–è¾‘ä¸­ | æ˜¾ç¤ºå­—æ•°ç»Ÿè®¡å’Œä¿å­˜/å–æ¶ˆæŒ‰é’® |
| ç‚¹å‡»å–æ¶ˆ | æ¢å¤åŸå†…å®¹ï¼Œé€€å‡ºç¼–è¾‘æ¨¡å¼ |
| Ctrl+Z | æ’¤é”€æœ€è¿‘ä¸€æ¬¡ä¿®æ”¹ |
| ç‚¹å‡»"é‡æ–°ç”Ÿæˆ" | è°ƒç”¨ POST /api/v1/tasks/{id}/regenerate-script |

---

### AC2: ä¿å­˜è„šæœ¬ä¿®æ”¹

**Scenario**
```gherkin
GIVEN ç”¨æˆ·ç¼–è¾‘äº†è„šæœ¬
WHEN ç”¨æˆ·ç‚¹å‡»ä¿å­˜
THEN
  - æäº¤ä¿®æ”¹åˆ°åç«¯ (PUT /api/v1/tasks/{id}/script)
  - æ›´æ–°ä»»åŠ¡è„šæœ¬å†…å®¹
  - æ˜¾ç¤ºä¿å­˜æˆåŠŸToast
  - æ›´æ–°task.statusä¸º'script_edited'
```

**Business Rules**
| ID | Rule |
|----|------|
| BR-2.1 | è‡ªåŠ¨ä¿å­˜è‰ç¨¿åˆ°localStorageï¼Œé”®å: `script_draft_${taskId}` |
| BR-2.2 | é¡µé¢ç¦»å¼€å‰æç¤ºæœªä¿å­˜å†…å®¹ï¼ˆbeforeunloadï¼‰ |
| BR-2.3 | ä¿å­˜æˆåŠŸåæ¸…é™¤æœ¬åœ°è‰ç¨¿ |
| BR-2.4 | ä¿å­˜æŒ‰é’®ä»…åœ¨å†…å®¹æœ‰ä¿®æ”¹æ—¶å¯ç”¨ |

**Data Validation**
| Field | Type | Required | Rules | Error Message |
|-------|------|----------|-------|---------------|
| paragraphs | Array | Yes | éç©ºæ•°ç»„ | è„šæœ¬å†…å®¹ä¸èƒ½ä¸ºç©º |
| paragraphs[].text | String | Yes | 1-500å­—ç¬¦ | æ®µè½å†…å®¹ä¸èƒ½ä¸ºç©ºä¸”ä¸è¶…è¿‡500å­— |
| paragraphs[].id | String | Yes | æœ‰æ•ˆæ®µè½ID | æ®µè½IDæ— æ•ˆ |

**Error Handling**
| Scenario | Code | Message | Action |
|----------|------|---------|--------|
| ä¿å­˜å¤±è´¥ | 500 | ä¿å­˜å¤±è´¥ï¼Œè¯·é‡è¯• | æ˜¾ç¤ºé‡è¯•æŒ‰é’®ï¼Œä¸æ¸…é™¤æœ¬åœ°å†…å®¹ |
| ç‰ˆæœ¬å†²çª | 409 | è„šæœ¬å·²è¢«ä¿®æ”¹ï¼Œè¯·åˆ·æ–°åé‡è¯• | æç¤ºåˆ·æ–°é¡µé¢ |
| éªŒè¯å¤±è´¥ | 422 | å†…å®¹æ ¼å¼é”™è¯¯ | é«˜äº®é”™è¯¯å­—æ®µ |

---

## Tasks / Subtasks

### Infrastructure Tasks (Shared)

- [x] **T0: ç»„ä»¶å’Œè·¯ç”±è®¾ç½®** `[ALL ACs]`
  - [x] åœ¨ `frontend/src/views/` åˆ›å»º `ScriptEditorView.vue` ç»„ä»¶
  - [x] æ›´æ–° `frontend/src/router/index.ts` æ·»åŠ è·¯ç”±å¤„ç†ï¼ˆtaskçŠ¶æ€ä¸ºscript_readyæ—¶æ˜¾ç¤ºï¼‰
  - [x] åˆ›å»º Pinia store `useScriptStore` ç®¡ç†è„šæœ¬çŠ¶æ€
  - [x] éªŒè¯è·¯ç”±æ­£ç¡®æŒ‚è½½

### Feature Implementation Tasks

- [x] **T1: å®ç°è„šæœ¬å±•ç¤ºä¸ç¼–è¾‘ç»„ä»¶** `[AC1]`

  **Test Specs**:
  | Scenario | Input | Expected | Level |
  |----------|-------|----------|-------|
  | è„šæœ¬æ®µè½æ¸²æŸ“ | paragraphsæ•°ç»„ | æ­£ç¡®æ˜¾ç¤º5-7æ®µ | unit |
  | é•œå¤´æ ‡è®°æ˜¾ç¤º | paragraph.section, shot_id | æ˜¾ç¤º"ã€å¼€åœºã€‘é•œå¤´#101" | unit |
  | ç¼–è¾‘æ¨¡å¼åˆ‡æ¢ | ç‚¹å‡»æ®µè½ | æ˜¾ç¤ºç¼–è¾‘æ¡†+å­—æ•°ç»Ÿè®¡ | unit |
  | å­—æ•°ç»Ÿè®¡å®æ—¶æ›´æ–° | è¾“å…¥æ–‡å­— | å­—æ•°å®æ—¶å˜åŒ– | unit |
  | æ’¤é”€åŠŸèƒ½ | Ctrl+Z | æ¢å¤ä¸Šä¸€çŠ¶æ€ | unit |
  | é‡æ–°ç”ŸæˆæŒ‰é’® | regenerate_remaining | æ˜¾ç¤ºå‰©ä½™æ¬¡æ•° | unit |
  | ç©ºå†…å®¹æ ¡éªŒ | text="" | æ˜¾ç¤ºé”™è¯¯æç¤º | unit |
  | [BLIND] ç©ºæ®µè½æ–‡æœ¬ | text="" | ç¦ç”¨ä¿å­˜+çº¢è¾¹æ¡† | unit |
  | [BLIND] APIè¶…æ—¶ | timeout | æ˜¾ç¤ºé‡è¯•æŒ‰é’® | integration |
  | [BLIND] å–æ¶ˆç¼–è¾‘ | ç‚¹å‡»å–æ¶ˆ | æ¢å¤åŸå†…å®¹ | unit |

  - [x] Write unit tests for ScriptParagraph component
  - [x] Implement `ScriptEditorView.vue` ä¸»é¡µé¢ç»„ä»¶
  - [x] Implement `ScriptParagraph.vue` æ®µè½ç¼–è¾‘ç»„ä»¶
  - [x] Implement `useScriptEditor` composableï¼ˆç¼–è¾‘çŠ¶æ€ç®¡ç†+æ’¤é”€æ ˆï¼‰
  - [x] Add beforeunload handler for unsaved changes
  - [x] Verify all tests pass

- [x] **T2: å®ç°è„šæœ¬ä¿å­˜åŠŸèƒ½** `[AC2]`

  **Test Specs**:
  | Scenario | Input | Expected | Level |
  |----------|-------|----------|-------|
  | ä¿å­˜æˆåŠŸ | valid paragraphs | è°ƒç”¨PUT APIï¼Œæ˜¾ç¤ºæˆåŠŸToast | integration |
  | ä¿å­˜æŒ‰é’®çŠ¶æ€ | hasChanges=false | æŒ‰é’®ç¦ç”¨ | unit |
  | æœ¬åœ°è‰ç¨¿ä¿å­˜ | å†…å®¹ä¿®æ”¹ | localStorageæœ‰å€¼ | unit |
  | æœ¬åœ°è‰ç¨¿æ¸…é™¤ | ä¿å­˜æˆåŠŸ | localStorageæ¸…ç©º | unit |
  | ä¿å­˜å¤±è´¥é‡è¯• | APIè¿”å›500 | æ˜¾ç¤ºé‡è¯•æŒ‰é’® | integration |
  | ç‰ˆæœ¬å†²çªå¤„ç† | APIè¿”å›409 | æç¤ºåˆ·æ–° | integration |
  | [BLIND] æ®µè½500å­—ç¬¦ | text.length=500 | æ­£å¸¸ä¿å­˜ | unit |
  | [BLIND] æ®µè½è¶…é™ | text.length=501 | æ˜¾ç¤ºé”™è¯¯æç¤º | unit |
  | [BLIND] ç½‘ç»œç¦»çº¿ä¿å­˜ | offline | ä¿å­˜è‰ç¨¿+æç¤º | integration |
  | [BLIND] åŒå‡»ä¿å­˜ | double-click | é˜²æŠ–å¤„ç† | unit |
  | [BLIND] æµè§ˆå™¨è¿”å› | unsaved+back | æ˜¾ç¤ºç¦»å¼€æç¤º | integration |
  | [BLIND] å¹¶å‘ç¼–è¾‘ | version conflict | æç¤ºåˆ·æ–°é¡µé¢ | integration |

  - [x] Write tests for save functionality
  - [x] Implement `frontend/src/api/script.ts` APIå®¢æˆ·ç«¯
  - [x] Implement `useScriptStore` ä¿å­˜é€»è¾‘
  - [x] Implement localStorage draftåŠŸèƒ½
  - [x] Verify all tests pass

- [x] **T3: APIé›†æˆä¸çŠ¶æ€åŒæ­¥** `[ALL ACs]`

  **Test Specs**:
  | Scenario | Input | Expected | Level |
  |----------|-------|----------|-------|
  | è·å–è„šæœ¬ | taskId | è¿”å›scriptå¯¹è±¡ | integration |
  | é‡æ–°ç”Ÿæˆ | taskId | è°ƒç”¨regenerate API | integration |
  | æ¬¡æ•°è¶…é™ | regenerate_remaining=0 | æŒ‰é’®ç¦ç”¨ | unit |
  | é”™è¯¯å¤„ç† | APIå¤±è´¥ | æ˜¾ç¤ºé”™è¯¯æ¶ˆæ¯ | unit |

  - [x] Write integration tests for API calls
  - [x] Implement script.ts API methods (getScript, saveScript, regenerateScript)
  - [x] Handle API error states in store
  - [x] Implement regenerate remaining count display
  - [x] Verify all tests pass

### Integration & Verification Tasks

- [x] **T4: Integration Testing** `[ALL ACs]`
  - [x] End-to-end script editing flow test (load â†’ edit â†’ save)
  - [x] Draft recovery test (edit â†’ close â†’ reopen)
  - [x] Regenerate flow test (click â†’ loading â†’ new content)

- [x] **T5: Final Verification** `[ALL ACs]`
  - [x] All tests passing (unit + integration) - 82 tests
  - [x] No TypeScript errors (vue-tsc --noEmit passes)
  - [x] Dev Log complete with implementation summary
  - [x] Status â†’ Review

## AC Coverage Matrix

| Task | AC1 | AC2 |
|------|:---:|:---:|
| T0: Infrastructure | âœ“ | âœ“ |
| T1: Script Display/Edit | âœ“ |   |
| T2: Save Functionality |   | âœ“ |
| T3: API Integration | âœ“ | âœ“ |
| T4: Integration | âœ“ | âœ“ |
| T5: Final | âœ“ | âœ“ |

---

## Dev Notes

### Technical Constraints

- ç¼–è¾‘å™¨ä½¿ç”¨ contenteditable æˆ– textareaï¼Œéœ€å¤„ç†ä¸­æ–‡è¾“å…¥æ³•å…¼å®¹
- æ’¤é”€æ ˆæœ€å¤šä¿ç•™20æ­¥æ“ä½œ
- localStorageè‰ç¨¿24å°æ—¶åè‡ªåŠ¨æ¸…ç†
- [â†’ docs/architecture/12-development-guidelines.md#12.4 Testing Strategy]

### ğŸ“ UI/UX Specification Reference

**Reference File**: `docs/front-end-spec.md`

| Section | Why Relevant |
|---------|--------------|
| Section 5.5 (Wireframe - è„šæœ¬ç¼–è¾‘) | é¡µé¢åŒæ å¸ƒå±€ï¼šå·¦ä¾§é•œå¤´é¢„è§ˆï¼Œå³ä¾§è„šæœ¬ç¼–è¾‘ |
| Section 4.1 (Main Flow - Step 4) | è„šæœ¬ç¼–è¾‘åœ¨ä¸»æµç¨‹ä¸­çš„ä½ç½®å’Œç”¨æˆ·å†³ç­–ç‚¹ |
| Section 6.2 (ScriptEditor Component) | ç»„ä»¶è§„æ ¼ï¼šview/editçŠ¶æ€ï¼Œreadonly/editing/saving/error |
| Section 3.4 (Page State Mapping) | `/task/:id` çŠ¶æ€ï¼šScript Ready â†’ Editing |
| Section 10.2 (Animation) | Step Transition 300ms ease-in-out |

### Accumulated Context (From Previous Stories)

| Resource Type | Name | Source Story | Action | Key Info |
|--------------|------|--------------|--------|----------|
| Table | scripts | 1.1 | REUSE | content(TEXT), version(INT), task_id(FK) |
| Table | tasks | 1.1 | REUSE | statuså­—æ®µï¼š'script_ready' â†’ 'script_edited' |
| Endpoint | GET /api/v1/tasks/{id}/script | 3.1 | CALL | è¿”å› { paragraphs[], regenerate_remaining } |
| Endpoint | PUT /api/v1/tasks/{id}/script | 3.1 | CALL | è¯·æ±‚ä½“ { paragraphs[] } |
| Endpoint | POST /api/v1/tasks/{id}/regenerate-script | 3.1 | CALL | è¿”å›æ–°è„šæœ¬ï¼Œæ›´æ–°regenerate_remaining |
| Model | R<T> | 1.1 | REUSE | ç»Ÿä¸€å“åº”åŒ…è£… |

### Data Models

**Script Response Interface** (from Story 3.1 API):
```typescript
interface ScriptResponse {
  id: number;
  taskId: number;
  paragraphs: ScriptParagraph[];
  version: number;
  regenerateRemaining: number;  // 5 - script_regenerate_count
  createdAt: string;
  updatedAt: string;
}

interface ScriptParagraph {
  id: string;           // e.g., "para_1"
  section: string;      // e.g., "å¼€åœº", "ç¯å¢ƒå±•ç¤º"
  shotId: number;       // å¯¹åº”é•œå¤´ID
  text: string;         // æ–‡æ¡ˆå†…å®¹
  estimatedDuration: number; // é¢„è®¡æ—¶é•¿(ç§’)
}

interface SaveScriptRequest {
  paragraphs: Array<{
    id: string;
    text: string;
  }>;
}
```

### File Locations

| File | Purpose | Action |
|------|---------|--------|
| `frontend/src/views/ScriptEditorView.vue` | è„šæœ¬ç¼–è¾‘ä¸»é¡µé¢ | CREATE |
| `frontend/src/components/script/ScriptParagraph.vue` | æ®µè½ç¼–è¾‘ç»„ä»¶ | CREATE |
| `frontend/src/composables/useScriptEditor.ts` | ç¼–è¾‘çŠ¶æ€ç®¡ç†composable | CREATE |
| `frontend/src/stores/script.ts` | è„šæœ¬Pinia store | CREATE |
| `frontend/src/api/script.ts` | è„šæœ¬ç›¸å…³APIå®¢æˆ·ç«¯ | CREATE |
| `frontend/src/router/index.ts` | è·¯ç”±é…ç½® | MODIFY |

### Deliverable Bindings

```yaml
deliverable_bindings:
  - deliverable: "frontend/src/views/ScriptEditorView.vue"
    consumer: "frontend/src/router/index.ts"
    binding_type: route_mount
    verify: "ScriptEditor.*View"

  - deliverable: "frontend/src/components/script/ScriptParagraph.vue"
    consumer: "frontend/src/views/ScriptEditorView.vue"
    binding_type: import_usage
    verify: "import.*ScriptParagraph"

  - deliverable: "frontend/src/stores/script.ts"
    consumer: "frontend/src/views/ScriptEditorView.vue"
    binding_type: import_usage
    verify: "useScriptStore"

  - deliverable: "frontend/src/api/script.ts"
    consumer: "frontend/src/stores/script.ts"
    binding_type: import_usage
    verify: "import.*from.*api/script"

  - deliverable: "frontend/src/composables/useScriptEditor.ts"
    consumer: "frontend/src/views/ScriptEditorView.vue"
    binding_type: import_usage
    verify: "useScriptEditor"
```

**Binding Status**: â³ Pending Dev verification

### Testing Requirements

- **Unit Tests**: ScriptParagraph rendering, edit mode toggle, char count, undo stack
- **Integration Tests**: API calls, localStorage draft, save flow
- **E2E Tests**: Full editâ†’save flow, draft recovery
- **Focus Areas**:
  - ä¸­æ–‡è¾“å…¥æ³•å…¼å®¹æ€§ï¼ˆcomposition eventsï¼‰
  - localStorageå®¹é‡é™åˆ¶å¤„ç†
  - beforeunloadåœ¨å„æµè§ˆå™¨çš„å…¼å®¹æ€§
  - æ’¤é”€æ ˆå†…å­˜ç®¡ç†

---

## AC Traceability Matrix

> **Dev**: Fill this section BEFORE self-review. Every AC needs evidence.
> **QA**: Verify each entry during AC Coverage Verification.

### AC1: è„šæœ¬å±•ç¤ºä¸ç¼–è¾‘

```yaml
ac_id: AC1
code_locations:
  - "frontend/src/views/ScriptEditorView.vue:1-274"
  - "frontend/src/components/script/ScriptParagraph.vue:1-199"
  - "frontend/src/composables/useScriptEditor.ts:1-189"
test_locations:
  - "frontend/src/components/script/__tests__/ScriptParagraph.spec.ts"
  - "frontend/src/composables/__tests__/useScriptEditor.spec.ts"
verification_type: unit_test
aspects_covered:
  main_scenario: true   # Paragraph display, click-to-edit, char count
  business_rules: true  # BR-1.1 char count, BR-1.2 suggested length, BR-1.3 regenerate
  data_validation: true # Empty text, max length validation
  error_handling: true  # API error display, validation errors
notes: "30 component tests + 17 composable tests covering all AC1 scenarios"
```

### AC2: ä¿å­˜è„šæœ¬ä¿®æ”¹

```yaml
ac_id: AC2
code_locations:
  - "frontend/src/stores/script.ts:1-346"
  - "frontend/src/api/script.ts:1-35"
test_locations:
  - "frontend/src/stores/__tests__/script.spec.ts"
  - "frontend/src/api/__tests__/script.spec.ts"
verification_type: unit_test
aspects_covered:
  main_scenario: true   # Save API call, clear edits on success
  business_rules: true  # BR-2.1 draft to localStorage, BR-2.2 beforeunload, BR-2.4 save button state
  data_validation: true # Paragraph validation before save
  error_handling: true  # 409 conflict, 500 server error
notes: "29 store tests + 6 API tests covering save, draft, undo functionality"
```

---

### Traceability Summary

| AC | Code Location | Test Location | Type | Status |
|----|---------------|---------------|------|--------|
| AC1 | ScriptEditorView, ScriptParagraph, useScriptEditor | ScriptParagraph.spec.ts, useScriptEditor.spec.ts | unit_test | âœ… |
| AC2 | stores/script.ts, api/script.ts | script.spec.ts (stores + api) | unit_test | âœ… |

**Legend**: âœ… Verified | â³ Pending | âŒ Missing

---

## Dev Agent Record

### Agent Model Used
Claude Opus 4.5 (claude-opus-4-5-20251101)

### Implementation Summary
Implemented script editor UI with Vue 3 Composition API and Pinia store. Features include:
- Click-to-edit paragraph editing with real-time character count
- Undo/redo support via Ctrl+Z with 20-entry stack
- Auto-draft to localStorage with 24-hour expiry and version check
- Regenerate script button with remaining count display
- beforeunload warning for unsaved changes
- Toast notifications for save/error feedback
- Responsive design with Tailwind CSS

### Database Changes (Structured)
```yaml
{}
# No database changes - frontend-only story
```

### API Endpoints Created (Structured)
```yaml
[]
# No new endpoints - consumes existing endpoints from Story 3.1
```

### Shared Models Created (Structured)
```yaml
frontend_types:
  ScriptParagraph:
    location: frontend/src/types/script.ts
    fields: [id, section, shotId, text, estimatedDuration]
  ScriptResponse:
    location: frontend/src/types/script.ts
    fields: [id, taskId, paragraphs, version, regenerateRemaining, createdAt, updatedAt]
  SaveScriptRequest:
    location: frontend/src/types/script.ts
    fields: [paragraphs[{id, text}]]
  SCRIPT_VALIDATION:
    location: frontend/src/types/script.ts
    constants: [MAX_PARAGRAPH_LENGTH=500, CHARS_PER_SECOND=4, MAX_UNDO_STACK=20, DRAFT_EXPIRY_HOURS=24]
```

### File List
| File | Action | Purpose |
|------|--------|---------|
| frontend/src/types/script.ts | CREATE | Type definitions |
| frontend/src/api/script.ts | CREATE | API client |
| frontend/src/stores/script.ts | CREATE | Pinia store |
| frontend/src/composables/useScriptEditor.ts | CREATE | Edit state composable |
| frontend/src/components/script/ScriptParagraph.vue | CREATE | Paragraph component |
| frontend/src/views/ScriptEditorView.vue | CREATE | Main page |
| frontend/src/router/index.ts | MODIFY | Add route |
| frontend/src/stores/__tests__/script.spec.ts | CREATE | Store tests (29) |
| frontend/src/components/script/__tests__/ScriptParagraph.spec.ts | CREATE | Component tests (30) |
| frontend/src/composables/__tests__/useScriptEditor.spec.ts | CREATE | Composable tests (17) |
| frontend/src/api/__tests__/script.spec.ts | CREATE | API tests (6) |

### Dev Log Reference
`docs/dev/logs/3.2-dev-log.md`

### Open Issues
None

---

## QA Results

- **Round**: 1
- **Risk Level**: LOW
- **Review Mode**: automated_only
- **Gate**: PASS
- **Tests**: 293/293 automated (100%), E2E skipped (low risk)
- **Blind Spots**: 12/12 covered (100%)
- **Issues**: 0 critical / 0 high / 0 medium
- **Gate File**: `docs/qa/gates/3.2-script-editor-ui.yml`

### Verification Summary

| Dimension | Status | Details |
|-----------|--------|---------|
| AC Coverage | âœ… PASS | Both ACs fully implemented with traceability |
| Test Evidence | âœ… PASS | 82 story-specific tests, all passing |
| Blind Spots | âœ… PASS | BOUNDARY, ERROR, FLOW, CONCURRENCY covered |
| Deliverables | âœ… PASS | All 7 files verified, bindings correct |
| Checkboxes | âœ… PASS | 28/28 complete with matching deliverables |

---

## QA Test Design Metadata

| Field | Value |
|-------|-------|
| test_design_level | Standard |
| test_design_status | Complete |
| complexity_indicators | 1 |
| security_sensitive | false |
| calculated_by | SM (JH) |
| calculation_date | 2026-01-25 |
| test_design_document | docs/qa/assessments/3.2-test-design-20260125.md |
| scenarios_total | 32 |
| scenarios_by_priority | P0: 6, P1: 16, P2: 8, P3: 2 |

---

## Change Log

| Date | Agent | Status Transition | Details/Link |
|------|-------|-------------------|--------------|
| 2026-01-25 | SM (JH) | Re-created â†’ Draft | Story re-drafted with complete template, UI/UX refs, deliverable bindings |
| 2026-01-25 | SM (JH) | Draft â†’ AwaitingTestDesign | Quality: 10/10, Complexity: 1/8, Arch Review: NOT_REQUIRED, Test Design: Standard |
| 2026-01-25 | QA (JW) | AwaitingTestDesign â†’ TestDesignComplete â†’ Approved | Test Design Doc: docs/qa/assessments/3.2-test-design-20260125.md, Scenarios: 32 (P0: 6, P1: 16, P2: 8, P3: 2), Blind Spots: 12. Ready for Dev implementation |
| 2026-01-25 | Dev (Claude Opus 4.5) | Approved â†’ Review | Implementation complete: 11 files created/modified, 82 unit tests (all pass), TypeScript check pass. Dev Log: docs/dev/logs/3.2-dev-log.md |
| 2026-01-25 | QA (JW) | Review â†’ Done | Gate: PASS, Round 1, Tests: 293/293 (100%), AC Coverage: 100%, Blind Spots: 12/12. Gate: docs/qa/gates/3.2-script-editor-ui.yml |

