# Test Design: Story 1.3 - 前端项目搭建与登录页面

**Date**: 2026-01-22
**QA Engineer**: JW
**Story Type**: Frontend UI (Vue3 + TypeScript)
**Test Design Level**: Standard

---

## Overview

| Metric | Value |
|--------|-------|
| **Total Scenarios** | 42 |
| **Unit Tests** | 16 (38%) |
| **Integration Tests** | 12 (29%) |
| **E2E Tests** | 6 (14%) |
| **Blind Spot Scenarios** | 8 (19%) |

| Priority | Count |
|----------|-------|
| P0 (Critical) | 10 |
| P1 (High) | 18 |
| P2 (Medium) | 14 |

---

## Scenarios by AC

### AC1: Vue3项目初始化

| ID | Lvl | Pri | Scenario | Input | Expected | Why |
|----|-----|-----|----------|-------|----------|-----|
| 1.3-UNIT-001 | U | P0 | Axios interceptor adds Authorization header | Request with stored token | Header `Authorization: Bearer {token}` added | BR-1.1: Security-critical |
| 1.3-UNIT-002 | U | P0 | Axios interceptor skips header for auth endpoints | Request to `/auth/*` | No Authorization header | Auth endpoints are public |
| 1.3-UNIT-003 | U | P0 | 401 response triggers token refresh | 401 response | Refresh token API called | BR-1.2: Session management |
| 1.3-UNIT-004 | U | P1 | Token refresh success retries original request | Refresh succeeds | Original request retried with new token | BR-1.2: Seamless UX |
| 1.3-UNIT-005 | U | P1 | Token refresh failure redirects to login | Refresh fails (401) | Redirect to /login | BR-1.2: Security fallback |
| 1.3-UNIT-006 | U | P1 | User store manages token state | Token set/get/clear | State updates correctly | State management |
| 1.3-INT-001 | I | P1 | Vue Router loads all routes | App initialization | Routes /login, /create, /task/:id accessible | Core navigation |
| 1.3-INT-002 | I | P1 | Pinia store persists across components | State update in one component | State reflected in another | State sharing |
| 1.3-INT-003 | I | P2 | Element Plus components render | Page load | Form components visible | UI framework |
| 1.3-INT-004 | I | P2 | TailwindCSS styles apply | Page load | Correct styling | UI framework |
| 1.3-INT-005 | I | P1 | API proxy routes to backend | API request | Correct backend endpoint called | Dev environment |

### AC2: 登录页面实现

| ID | Lvl | Pri | Scenario | Input | Expected | Why |
|----|-----|-----|----------|-------|----------|-----|
| 1.3-UNIT-007 | U | P0 | Valid phone format passes | `13800138000` | Validation passes | BR-2.1: Core validation |
| 1.3-UNIT-008 | U | P0 | Invalid phone format fails | `1380013800` (10 digits) | Error: "请输入正确的手机号" | BR-2.1: Input validation |
| 1.3-UNIT-009 | U | P1 | Phone not starting with 1 fails | `23800138000` | Error: "请输入正确的手机号" | BR-2.1: CN phone format |
| 1.3-UNIT-010 | U | P1 | Phone with non-numeric fails | `1380013800a` | Error: "请输入正确的手机号" | BR-2.1: Type validation |
| 1.3-UNIT-011 | U | P0 | Valid code format passes | `123456` | Validation passes | Core validation |
| 1.3-UNIT-012 | U | P1 | Invalid code format fails | `12345` (5 digits) | Error: "请输入6位验证码" | Input validation |
| 1.3-UNIT-013 | U | P1 | Countdown timer decrements | Start countdown | 60 -> 59 -> ... -> 0 | BR-2.2: Rate limit UX |
| 1.3-UNIT-014 | U | P1 | Countdown enables button at 0 | Countdown reaches 0 | Button enabled | BR-2.2: Re-enable send |
| 1.3-UNIT-015 | U | P1 | Token stored to localStorage | Login success | Token in localStorage | BR-2.3: Persistence |
| 1.3-UNIT-016 | U | P2 | Phone mask for display | `13800138000` | `138****8000` | Privacy |
| 1.3-INT-006 | I | P0 | Send code API success | Valid phone | Code sent, countdown starts | Core flow |
| 1.3-INT-007 | I | P0 | Login API success | Valid phone + code | Token returned, user stored | Core flow |
| 1.3-INT-008 | I | P1 | Login redirects to original page | Login after redirect | Navigate to original URL | UX requirement |
| 1.3-INT-009 | I | P0 | Route guard blocks unauthenticated | Access /create without token | Redirect to /login | Security |
| 1.3-INT-010 | I | P1 | Route guard allows authenticated | Access /create with token | Page loads | Authorization |
| 1.3-INT-011 | I | P1 | Route guard saves redirect URL | Blocked request to /create | `redirect` query param saved | UX requirement |
| 1.3-INT-012 | I | P2 | Auto-focus phone input on load | Page load | Phone input focused | UI Interaction |
| 1.3-E2E-001 | E | P0 | Complete login flow - happy path | Valid phone, valid code | Login success, redirect to home | Critical journey |
| 1.3-E2E-002 | E | P0 | Login with redirect preservation | Access /create -> login -> success | Redirect to /create | Critical journey |
| 1.3-E2E-003 | E | P1 | Send code shows countdown | Click send code | Button shows "60s" countdown | User feedback |
| 1.3-E2E-004 | E | P1 | Login success shows toast | Valid login | Success toast, 1s delay, redirect | UI Interaction |
| 1.3-E2E-005 | E | P2 | Network error shows retry | Disconnect network | Error message + retry button | Error UX |
| 1.3-E2E-006 | E | P2 | Login page layout matches spec | Page load | Layout per front-end-spec.md | Visual validation |

---

## Blind Spot Scenarios [BLIND-SPOT]

| ID | Category | Pri | Scenario | Check Point | Why |
|----|----------|-----|----------|-------------|-----|
| 1.3-BLIND-BOUNDARY-001 | BOUNDARY | P1 | Empty phone input submission | BOUNDARY-001 | Null/empty validation |
| 1.3-BLIND-BOUNDARY-002 | BOUNDARY | P1 | Empty code input submission | BOUNDARY-001 | Null/empty validation |
| 1.3-BLIND-BOUNDARY-003 | BOUNDARY | P2 | Phone with 12 digits | BOUNDARY-004 | Beyond max length |
| 1.3-BLIND-FLOW-001 | FLOW | P1 | Double-click send code button | FLOW-002 | Duplicate submission |
| 1.3-BLIND-FLOW-002 | FLOW | P1 | Browser back after login | FLOW-005 | Navigation edge case |
| 1.3-BLIND-FLOW-003 | FLOW | P2 | Direct URL to /login when logged in | FLOW-003 | Out-of-order access |
| 1.3-BLIND-ERROR-001 | ERROR | P1 | Network timeout on send code | ERROR-001 | Network failure |
| 1.3-BLIND-ERROR-002 | ERROR | P1 | API returns 429 rate limit | ERROR-005 | Resource exhaustion |

---

## Test Specs Summary by AC (for Story backfill)

### AC1 Key Test Specs

| Scenario | Input | Expected | Level |
|----------|-------|----------|-------|
| Auth header auto-added | Request + stored token | `Authorization: Bearer {token}` | unit |
| Auth endpoints excluded | Request to `/auth/*` | No header added | unit |
| 401 triggers refresh | 401 response | Refresh API called | unit |
| Refresh fail -> logout | Refresh returns 401 | Redirect to /login | unit |
| Routes load correctly | App init | All routes accessible | integration |

### AC2 Key Test Specs

| Scenario | Input | Expected | Level |
|----------|-------|----------|-------|
| Valid phone passes | `13800138000` | validation passes | unit |
| Phone 10 digits fails | `1380013800` | "请输入正确的手机号" | unit |
| Phone non-numeric fails | `1380013800a` | "请输入正确的手机号" | unit |
| Valid code passes | `123456` | validation passes | unit |
| Code 5 digits fails | `12345` | "请输入6位验证码" | unit |
| Countdown 60->0 | Click send | Decrement every second | unit |
| Send code API | Valid phone | 200 OK, countdown starts | integration |
| Login API | Valid credentials | Token returned | integration |
| Route guard blocks | No token + /create | Redirect to /login | integration |
| Complete login E2E | Phone + code | Login success, redirect | e2e |

---

## Risk Coverage

| Risk | Mitigated By |
|------|--------------|
| Token theft | 1.3-UNIT-001, 1.3-UNIT-005 (secure handling) |
| Session hijacking | 1.3-UNIT-003, 1.3-UNIT-004 (refresh flow) |
| Brute force | 1.3-BLIND-ERROR-002 (rate limit handling) |
| Unauthorized access | 1.3-INT-009, 1.3-INT-010 (route guards) |
| Poor UX on error | 1.3-E2E-005, 1.3-BLIND-ERROR-001 (error feedback) |

---

## Execution Order

1. **P0 Unit Tests** (10 scenarios) - Core validation and security
2. **P0 Integration Tests** (4 scenarios) - API and route guard
3. **P0 E2E Tests** (2 scenarios) - Critical user journeys
4. **P1 Tests** (18 scenarios) - Including blind spots
5. **P2 Tests** (14 scenarios) - Edge cases and polish

---

## Notes

- All unit tests should mock API calls
- Integration tests require backend services running (Story 1.2 APIs)
- E2E tests require full environment (frontend + backend)
- Blind spot scenarios should be implemented as unit/integration tests where possible
- Test file locations per architecture: `frontend/src/__tests__/` or co-located with components
